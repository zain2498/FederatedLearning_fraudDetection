2025-12-03 22:30:35,116 - INFO - Hierarchical Federated Learning system initialized
2025-12-03 22:30:35,116 - INFO - Project path: d:/PracticeProject/fraud_detection_project
2025-12-03 22:30:35,116 - INFO - Edge configuration: {'edge_1': [1, 2, 3], 'edge_2': [4, 5]}
2025-12-03 22:30:35,116 - INFO - Starting complete FL experiment with smote data and mlp model
2025-12-03 22:30:35,116 - INFO - Loading data with balance method: smote
2025-12-03 22:30:35,200 - INFO - Merchant 1: 12777 train, 3195 test samples
2025-12-03 22:30:35,205 - INFO -   Fraud rate: 49.92%
2025-12-03 22:30:35,273 - INFO - Merchant 2: 12777 train, 3195 test samples
2025-12-03 22:30:35,273 - INFO -   Fraud rate: 50.03%
2025-12-03 22:30:35,354 - INFO - Merchant 3: 12777 train, 3195 test samples
2025-12-03 22:30:35,354 - INFO -   Fraud rate: 50.21%
2025-12-03 22:30:35,418 - INFO - Merchant 4: 12777 train, 3195 test samples
2025-12-03 22:30:35,418 - INFO -   Fraud rate: 50.64%
2025-12-03 22:30:35,508 - INFO - Merchant 5: 12779 train, 3195 test samples
2025-12-03 22:30:35,508 - INFO -   Fraud rate: 49.19%
2025-12-03 22:30:35,510 - INFO - Successfully loaded data for 5 merchants
2025-12-03 22:30:35,510 - INFO - Training centralized baseline...
2025-12-03 22:30:35,510 - INFO - Training centralized baseline model...
2025-12-03 22:30:51,666 - INFO - Centralized Baseline Evaluation:
2025-12-03 22:30:51,666 - INFO -   Accuracy: 0.9988
2025-12-03 22:30:51,666 - INFO -   Precision: 0.9976
2025-12-03 22:30:51,666 - INFO -   Recall: 1.0000
2025-12-03 22:30:51,666 - INFO -   F1-Score: 0.9988
2025-12-03 22:30:51,666 - INFO -   ROC-AUC: 0.9999
2025-12-03 22:30:51,679 - INFO - Training pure federated learning...
2025-12-03 22:30:51,681 - INFO - Training pure federated learning model...
2025-12-03 22:30:51,703 - INFO - Pure FL Round 1/10
2025-12-03 22:30:57,331 - INFO -   merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:31:03,521 - INFO -   merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:31:09,565 - INFO -   merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:31:15,457 - INFO -   merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:31:21,617 - INFO -   merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:31:21,664 - INFO - Pure FL Round 1 Evaluation:
2025-12-03 22:31:21,664 - INFO -   Accuracy: 0.5656
2025-12-03 22:31:21,665 - INFO -   Precision: 0.5383
2025-12-03 22:31:21,665 - INFO -   Recall: 0.9221
2025-12-03 22:31:21,665 - INFO -   F1-Score: 0.6798
2025-12-03 22:31:21,665 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:31:21,665 - INFO - Pure FL Round 2/10
2025-12-03 22:31:27,031 - INFO -   merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:31:32,367 - INFO -   merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:31:37,735 - INFO -   merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:31:43,279 - INFO -   merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:31:49,288 - INFO -   merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:31:49,322 - INFO - Pure FL Round 2 Evaluation:
2025-12-03 22:31:49,322 - INFO -   Accuracy: 0.5656
2025-12-03 22:31:49,329 - INFO -   Precision: 0.5383
2025-12-03 22:31:49,329 - INFO -   Recall: 0.9221
2025-12-03 22:31:49,330 - INFO -   F1-Score: 0.6798
2025-12-03 22:31:49,331 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:31:49,331 - INFO - Pure FL Round 3/10
2025-12-03 22:31:55,509 - INFO -   merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:32:01,483 - INFO -   merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:32:07,677 - INFO -   merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:32:13,722 - INFO -   merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:32:19,939 - INFO -   merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:32:19,981 - INFO - Pure FL Round 3 Evaluation:
2025-12-03 22:32:19,981 - INFO -   Accuracy: 0.5656
2025-12-03 22:32:19,981 - INFO -   Precision: 0.5383
2025-12-03 22:32:19,981 - INFO -   Recall: 0.9221
2025-12-03 22:32:19,981 - INFO -   F1-Score: 0.6798
2025-12-03 22:32:19,981 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:32:19,981 - INFO - Pure FL Round 4/10
2025-12-03 22:32:25,642 - INFO -   merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:32:30,211 - INFO -   merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:32:34,948 - INFO -   merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:32:39,423 - INFO -   merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:32:43,545 - INFO -   merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:32:43,586 - INFO - Pure FL Round 4 Evaluation:
2025-12-03 22:32:43,586 - INFO -   Accuracy: 0.5656
2025-12-03 22:32:43,586 - INFO -   Precision: 0.5383
2025-12-03 22:32:43,586 - INFO -   Recall: 0.9221
2025-12-03 22:32:43,589 - INFO -   F1-Score: 0.6798
2025-12-03 22:32:43,589 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:32:43,590 - INFO - Pure FL Round 5/10
2025-12-03 22:32:48,422 - INFO -   merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:32:52,929 - INFO -   merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:32:57,931 - INFO -   merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:33:03,214 - INFO -   merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:33:08,504 - INFO -   merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:33:08,542 - INFO - Pure FL Round 5 Evaluation:
2025-12-03 22:33:08,542 - INFO -   Accuracy: 0.5656
2025-12-03 22:33:08,542 - INFO -   Precision: 0.5383
2025-12-03 22:33:08,542 - INFO -   Recall: 0.9221
2025-12-03 22:33:08,542 - INFO -   F1-Score: 0.6798
2025-12-03 22:33:08,542 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:33:08,542 - INFO - Pure FL Round 6/10
2025-12-03 22:33:14,753 - INFO -   merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:33:20,486 - INFO -   merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:33:26,274 - INFO -   merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:33:32,205 - INFO -   merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:33:38,571 - INFO -   merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:33:38,612 - INFO - Pure FL Round 6 Evaluation:
2025-12-03 22:33:38,612 - INFO -   Accuracy: 0.5656
2025-12-03 22:33:38,612 - INFO -   Precision: 0.5383
2025-12-03 22:33:38,615 - INFO -   Recall: 0.9221
2025-12-03 22:33:38,615 - INFO -   F1-Score: 0.6798
2025-12-03 22:33:38,616 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:33:38,617 - INFO - Pure FL Round 7/10
2025-12-03 22:33:43,877 - INFO -   merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:33:49,716 - INFO -   merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:33:56,217 - INFO -   merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:34:02,154 - INFO -   merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:34:08,467 - INFO -   merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:34:08,512 - INFO - Pure FL Round 7 Evaluation:
2025-12-03 22:34:08,512 - INFO -   Accuracy: 0.5656
2025-12-03 22:34:08,512 - INFO -   Precision: 0.5383
2025-12-03 22:34:08,512 - INFO -   Recall: 0.9221
2025-12-03 22:34:08,512 - INFO -   F1-Score: 0.6798
2025-12-03 22:34:08,512 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:34:08,512 - INFO - Pure FL Round 8/10
2025-12-03 22:34:14,855 - INFO -   merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:34:21,465 - INFO -   merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:34:27,927 - INFO -   merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:34:34,721 - INFO -   merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:34:41,604 - INFO -   merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:34:41,641 - INFO - Pure FL Round 8 Evaluation:
2025-12-03 22:34:41,641 - INFO -   Accuracy: 0.5656
2025-12-03 22:34:41,641 - INFO -   Precision: 0.5383
2025-12-03 22:34:41,641 - INFO -   Recall: 0.9221
2025-12-03 22:34:41,641 - INFO -   F1-Score: 0.6798
2025-12-03 22:34:41,641 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:34:41,641 - INFO - Pure FL Round 9/10
2025-12-03 22:34:47,573 - INFO -   merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:34:52,294 - INFO -   merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:34:57,404 - INFO -   merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:35:03,855 - INFO -   merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:35:10,330 - INFO -   merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:35:10,445 - INFO - Pure FL Round 9 Evaluation:
2025-12-03 22:35:10,447 - INFO -   Accuracy: 0.5656
2025-12-03 22:35:10,447 - INFO -   Precision: 0.5383
2025-12-03 22:35:10,447 - INFO -   Recall: 0.9221
2025-12-03 22:35:10,447 - INFO -   F1-Score: 0.6798
2025-12-03 22:35:10,447 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:35:10,447 - INFO - Pure FL Round 10/10
2025-12-03 22:35:21,948 - INFO -   merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:35:34,921 - INFO -   merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:35:49,274 - INFO -   merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:36:04,613 - INFO -   merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:36:19,297 - INFO -   merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:36:19,423 - INFO - Pure FL Round 10 Evaluation:
2025-12-03 22:36:19,425 - INFO -   Accuracy: 0.5656
2025-12-03 22:36:19,425 - INFO -   Precision: 0.5383
2025-12-03 22:36:19,426 - INFO -   Recall: 0.9221
2025-12-03 22:36:19,426 - INFO -   F1-Score: 0.6798
2025-12-03 22:36:19,427 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:36:19,430 - INFO - Training hierarchical federated learning...
2025-12-03 22:36:19,430 - INFO - Training hierarchical federated learning model...
2025-12-03 22:36:19,587 - INFO - Hierarchical FL Round 1/10
2025-12-03 22:36:19,588 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-03 22:36:32,433 - INFO -     merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:36:46,536 - INFO -     merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:36:58,242 - INFO -     merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:36:58,243 - INFO - Aggregating 3 models at edge node
2025-12-03 22:36:58,244 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-03 22:36:58,245 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-03 22:37:08,962 - INFO -     merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:37:17,113 - INFO -     merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:37:17,113 - INFO - Aggregating 2 models at edge node
2025-12-03 22:37:17,113 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-03 22:37:17,113 - INFO - Aggregating 2 edge models at central server
2025-12-03 22:37:17,113 - INFO -   Central server aggregated 2 edge nodes
2025-12-03 22:37:17,160 - INFO - Hierarchical FL Round 1 Evaluation:
2025-12-03 22:37:17,160 - INFO -   Accuracy: 0.5656
2025-12-03 22:37:17,161 - INFO -   Precision: 0.5383
2025-12-03 22:37:17,162 - INFO -   Recall: 0.9221
2025-12-03 22:37:17,162 - INFO -   F1-Score: 0.6798
2025-12-03 22:37:17,163 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:37:17,163 - INFO - Hierarchical FL Round 2/10
2025-12-03 22:37:17,164 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-03 22:37:23,948 - INFO -     merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:37:30,435 - INFO -     merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:37:36,685 - INFO -     merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:37:36,687 - INFO - Aggregating 3 models at edge node
2025-12-03 22:37:36,687 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-03 22:37:36,687 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-03 22:37:43,317 - INFO -     merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:37:50,126 - INFO -     merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:37:50,127 - INFO - Aggregating 2 models at edge node
2025-12-03 22:37:50,127 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-03 22:37:50,127 - INFO - Aggregating 2 edge models at central server
2025-12-03 22:37:50,127 - INFO -   Central server aggregated 2 edge nodes
2025-12-03 22:37:50,171 - INFO - Hierarchical FL Round 2 Evaluation:
2025-12-03 22:37:50,171 - INFO -   Accuracy: 0.5656
2025-12-03 22:37:50,171 - INFO -   Precision: 0.5383
2025-12-03 22:37:50,171 - INFO -   Recall: 0.9221
2025-12-03 22:37:50,173 - INFO -   F1-Score: 0.6798
2025-12-03 22:37:50,173 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:37:50,174 - INFO - Hierarchical FL Round 3/10
2025-12-03 22:37:50,174 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-03 22:37:56,740 - INFO -     merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:38:02,918 - INFO -     merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:38:08,823 - INFO -     merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:38:08,823 - INFO - Aggregating 3 models at edge node
2025-12-03 22:38:08,823 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-03 22:38:08,823 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-03 22:38:14,967 - INFO -     merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:38:21,924 - INFO -     merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:38:21,925 - INFO - Aggregating 2 models at edge node
2025-12-03 22:38:21,925 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-03 22:38:21,925 - INFO - Aggregating 2 edge models at central server
2025-12-03 22:38:21,925 - INFO -   Central server aggregated 2 edge nodes
2025-12-03 22:38:21,971 - INFO - Hierarchical FL Round 3 Evaluation:
2025-12-03 22:38:21,971 - INFO -   Accuracy: 0.5656
2025-12-03 22:38:21,971 - INFO -   Precision: 0.5383
2025-12-03 22:38:21,971 - INFO -   Recall: 0.9221
2025-12-03 22:38:21,971 - INFO -   F1-Score: 0.6798
2025-12-03 22:38:21,971 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:38:21,971 - INFO - Hierarchical FL Round 4/10
2025-12-03 22:38:21,971 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-03 22:38:29,968 - INFO -     merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:38:36,930 - INFO -     merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:38:43,878 - INFO -     merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:38:43,878 - INFO - Aggregating 3 models at edge node
2025-12-03 22:38:43,879 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-03 22:38:43,879 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-03 22:38:51,527 - INFO -     merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:38:58,766 - INFO -     merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:38:58,767 - INFO - Aggregating 2 models at edge node
2025-12-03 22:38:58,768 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-03 22:38:58,768 - INFO - Aggregating 2 edge models at central server
2025-12-03 22:38:58,769 - INFO -   Central server aggregated 2 edge nodes
2025-12-03 22:38:58,867 - INFO - Hierarchical FL Round 4 Evaluation:
2025-12-03 22:38:58,868 - INFO -   Accuracy: 0.5656
2025-12-03 22:38:58,868 - INFO -   Precision: 0.5383
2025-12-03 22:38:58,868 - INFO -   Recall: 0.9221
2025-12-03 22:38:58,869 - INFO -   F1-Score: 0.6798
2025-12-03 22:38:58,869 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:38:58,870 - INFO - Hierarchical FL Round 5/10
2025-12-03 22:38:58,870 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-03 22:39:06,249 - INFO -     merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:39:13,056 - INFO -     merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:39:19,832 - INFO -     merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:39:19,833 - INFO - Aggregating 3 models at edge node
2025-12-03 22:39:19,834 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-03 22:39:19,834 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-03 22:39:26,371 - INFO -     merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:39:33,144 - INFO -     merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:39:33,145 - INFO - Aggregating 2 models at edge node
2025-12-03 22:39:33,145 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-03 22:39:33,146 - INFO - Aggregating 2 edge models at central server
2025-12-03 22:39:33,147 - INFO -   Central server aggregated 2 edge nodes
2025-12-03 22:39:33,249 - INFO - Hierarchical FL Round 5 Evaluation:
2025-12-03 22:39:33,250 - INFO -   Accuracy: 0.5656
2025-12-03 22:39:33,250 - INFO -   Precision: 0.5383
2025-12-03 22:39:33,251 - INFO -   Recall: 0.9221
2025-12-03 22:39:33,251 - INFO -   F1-Score: 0.6798
2025-12-03 22:39:33,252 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:39:33,252 - INFO - Hierarchical FL Round 6/10
2025-12-03 22:39:33,253 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-03 22:39:40,163 - INFO -     merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:39:46,965 - INFO -     merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:39:53,934 - INFO -     merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:39:53,935 - INFO - Aggregating 3 models at edge node
2025-12-03 22:39:53,935 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-03 22:39:53,937 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-03 22:40:01,042 - INFO -     merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:40:08,113 - INFO -     merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:40:08,113 - INFO - Aggregating 2 models at edge node
2025-12-03 22:40:08,114 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-03 22:40:08,114 - INFO - Aggregating 2 edge models at central server
2025-12-03 22:40:08,114 - INFO -   Central server aggregated 2 edge nodes
2025-12-03 22:40:08,221 - INFO - Hierarchical FL Round 6 Evaluation:
2025-12-03 22:40:08,223 - INFO -   Accuracy: 0.5656
2025-12-03 22:40:08,223 - INFO -   Precision: 0.5383
2025-12-03 22:40:08,223 - INFO -   Recall: 0.9221
2025-12-03 22:40:08,224 - INFO -   F1-Score: 0.6798
2025-12-03 22:40:08,224 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:40:08,224 - INFO - Hierarchical FL Round 7/10
2025-12-03 22:40:08,224 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-03 22:40:15,303 - INFO -     merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:40:22,473 - INFO -     merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:40:29,614 - INFO -     merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:40:29,614 - INFO - Aggregating 3 models at edge node
2025-12-03 22:40:29,615 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-03 22:40:29,615 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-03 22:40:37,107 - INFO -     merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:40:44,521 - INFO -     merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:40:44,527 - INFO - Aggregating 2 models at edge node
2025-12-03 22:40:44,527 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-03 22:40:44,527 - INFO - Aggregating 2 edge models at central server
2025-12-03 22:40:44,527 - INFO -   Central server aggregated 2 edge nodes
2025-12-03 22:40:44,587 - INFO - Hierarchical FL Round 7 Evaluation:
2025-12-03 22:40:44,587 - INFO -   Accuracy: 0.5656
2025-12-03 22:40:44,587 - INFO -   Precision: 0.5383
2025-12-03 22:40:44,588 - INFO -   Recall: 0.9221
2025-12-03 22:40:44,588 - INFO -   F1-Score: 0.6798
2025-12-03 22:40:44,588 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:40:44,588 - INFO - Hierarchical FL Round 8/10
2025-12-03 22:40:44,588 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-03 22:40:51,230 - INFO -     merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:40:57,433 - INFO -     merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:41:03,605 - INFO -     merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:41:03,606 - INFO - Aggregating 3 models at edge node
2025-12-03 22:41:03,606 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-03 22:41:03,606 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-03 22:41:09,633 - INFO -     merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:41:15,340 - INFO -     merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:41:15,340 - INFO - Aggregating 2 models at edge node
2025-12-03 22:41:15,340 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-03 22:41:15,340 - INFO - Aggregating 2 edge models at central server
2025-12-03 22:41:15,340 - INFO -   Central server aggregated 2 edge nodes
2025-12-03 22:41:15,383 - INFO - Hierarchical FL Round 8 Evaluation:
2025-12-03 22:41:15,383 - INFO -   Accuracy: 0.5656
2025-12-03 22:41:15,383 - INFO -   Precision: 0.5383
2025-12-03 22:41:15,383 - INFO -   Recall: 0.9221
2025-12-03 22:41:15,383 - INFO -   F1-Score: 0.6798
2025-12-03 22:41:15,383 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:41:15,383 - INFO - Hierarchical FL Round 9/10
2025-12-03 22:41:15,383 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-03 22:41:21,832 - INFO -     merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:41:26,821 - INFO -     merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:41:32,418 - INFO -     merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:41:32,418 - INFO - Aggregating 3 models at edge node
2025-12-03 22:41:32,418 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-03 22:41:32,421 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-03 22:41:39,062 - INFO -     merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:41:45,171 - INFO -     merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:41:45,171 - INFO - Aggregating 2 models at edge node
2025-12-03 22:41:45,173 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-03 22:41:45,173 - INFO - Aggregating 2 edge models at central server
2025-12-03 22:41:45,175 - INFO -   Central server aggregated 2 edge nodes
2025-12-03 22:41:45,219 - INFO - Hierarchical FL Round 9 Evaluation:
2025-12-03 22:41:45,219 - INFO -   Accuracy: 0.5656
2025-12-03 22:41:45,219 - INFO -   Precision: 0.5383
2025-12-03 22:41:45,219 - INFO -   Recall: 0.9221
2025-12-03 22:41:45,219 - INFO -   F1-Score: 0.6798
2025-12-03 22:41:45,219 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:41:45,219 - INFO - Hierarchical FL Round 10/10
2025-12-03 22:41:45,219 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-03 22:41:51,557 - INFO -     merchant_1: 12777 samples, loss: 0.0003
2025-12-03 22:41:57,742 - INFO -     merchant_2: 12777 samples, loss: 0.0003
2025-12-03 22:42:04,126 - INFO -     merchant_3: 12777 samples, loss: 0.0003
2025-12-03 22:42:04,126 - INFO - Aggregating 3 models at edge node
2025-12-03 22:42:04,126 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-03 22:42:04,126 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-03 22:42:10,183 - INFO -     merchant_4: 12777 samples, loss: 0.0003
2025-12-03 22:42:16,496 - INFO -     merchant_5: 12779 samples, loss: 0.0003
2025-12-03 22:42:16,496 - INFO - Aggregating 2 models at edge node
2025-12-03 22:42:16,496 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-03 22:42:16,496 - INFO - Aggregating 2 edge models at central server
2025-12-03 22:42:16,496 - INFO -   Central server aggregated 2 edge nodes
2025-12-03 22:42:16,542 - INFO - Hierarchical FL Round 10 Evaluation:
2025-12-03 22:42:16,542 - INFO -   Accuracy: 0.5656
2025-12-03 22:42:16,542 - INFO -   Precision: 0.5383
2025-12-03 22:42:16,542 - INFO -   Recall: 0.9221
2025-12-03 22:42:16,542 - INFO -   F1-Score: 0.6798
2025-12-03 22:42:16,542 - INFO -   ROC-AUC: 0.6843
2025-12-03 22:42:16,542 - INFO - Generating performance comparison...
2025-12-03 22:42:16,566 - INFO - Plotting training curves...
2025-12-04 12:00:27,921 - INFO - Saving models...
2025-12-04 12:00:27,933 - INFO - Saved centralized model to d:/PracticeProject/fraud_detection_project\trained_models\centralized_model.pkl
2025-12-04 12:00:27,941 - INFO - Saved pure_fl model to d:/PracticeProject/fraud_detection_project\trained_models\pure_fl_model.pkl
2025-12-04 12:00:27,950 - INFO - Saved hierarchical_fl model to d:/PracticeProject/fraud_detection_project\trained_models\hierarchical_fl_model.pkl
2025-12-04 12:00:27,956 - INFO - Experiment completed successfully! Results saved to d:/PracticeProject/fraud_detection_project\experiment_results_smote_mlp.json
2025-12-04 12:00:27,962 - INFO - Starting complete FL experiment with smote data and logistic model
2025-12-04 12:00:27,963 - INFO - Loading data with balance method: smote
2025-12-04 12:00:28,044 - INFO - Merchant 1: 12777 train, 3195 test samples
2025-12-04 12:00:28,044 - INFO -   Fraud rate: 49.92%
2025-12-04 12:00:28,151 - INFO - Merchant 2: 12777 train, 3195 test samples
2025-12-04 12:00:28,151 - INFO -   Fraud rate: 50.03%
2025-12-04 12:00:28,239 - INFO - Merchant 3: 12777 train, 3195 test samples
2025-12-04 12:00:28,243 - INFO -   Fraud rate: 50.21%
2025-12-04 12:00:28,322 - INFO - Merchant 4: 12777 train, 3195 test samples
2025-12-04 12:00:28,322 - INFO -   Fraud rate: 50.64%
2025-12-04 12:00:28,402 - INFO - Merchant 5: 12779 train, 3195 test samples
2025-12-04 12:00:28,404 - INFO -   Fraud rate: 49.19%
2025-12-04 12:00:28,404 - INFO - Successfully loaded data for 5 merchants
2025-12-04 12:00:28,404 - INFO - Training centralized baseline...
2025-12-04 12:00:28,405 - INFO - Training centralized baseline model...
2025-12-04 12:00:28,495 - INFO - Centralized Baseline Evaluation:
2025-12-04 12:00:28,495 - INFO -   Accuracy: 0.8705
2025-12-04 12:00:28,495 - INFO -   Precision: 0.8623
2025-12-04 12:00:28,502 - INFO -   Recall: 0.8819
2025-12-04 12:00:28,502 - INFO -   F1-Score: 0.8720
2025-12-04 12:00:28,502 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:28,502 - INFO - Training pure federated learning...
2025-12-04 12:00:28,502 - INFO - Training pure federated learning model...
2025-12-04 12:00:28,512 - INFO - Pure FL Round 1/10
2025-12-04 12:00:28,534 - INFO -   merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:28,556 - INFO -   merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:28,580 - INFO -   merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:28,600 - INFO -   merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:28,622 - INFO -   merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:28,647 - INFO - Pure FL Round 1 Evaluation:
2025-12-04 12:00:28,647 - INFO -   Accuracy: 0.8706
2025-12-04 12:00:28,647 - INFO -   Precision: 0.8621
2025-12-04 12:00:28,647 - INFO -   Recall: 0.8823
2025-12-04 12:00:28,647 - INFO -   F1-Score: 0.8721
2025-12-04 12:00:28,647 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:28,647 - INFO - Pure FL Round 2/10
2025-12-04 12:00:28,680 - INFO -   merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:28,705 - INFO -   merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:28,733 - INFO -   merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:28,763 - INFO -   merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:28,786 - INFO -   merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:28,813 - INFO - Pure FL Round 2 Evaluation:
2025-12-04 12:00:28,813 - INFO -   Accuracy: 0.8706
2025-12-04 12:00:28,813 - INFO -   Precision: 0.8621
2025-12-04 12:00:28,813 - INFO -   Recall: 0.8823
2025-12-04 12:00:28,813 - INFO -   F1-Score: 0.8721
2025-12-04 12:00:28,813 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:28,813 - INFO - Pure FL Round 3/10
2025-12-04 12:00:28,847 - INFO -   merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:28,872 - INFO -   merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:28,902 - INFO -   merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:28,936 - INFO -   merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:28,966 - INFO -   merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:28,997 - INFO - Pure FL Round 3 Evaluation:
2025-12-04 12:00:28,997 - INFO -   Accuracy: 0.8706
2025-12-04 12:00:28,997 - INFO -   Precision: 0.8621
2025-12-04 12:00:28,997 - INFO -   Recall: 0.8823
2025-12-04 12:00:28,997 - INFO -   F1-Score: 0.8721
2025-12-04 12:00:28,997 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:28,997 - INFO - Pure FL Round 4/10
2025-12-04 12:00:29,024 - INFO -   merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:29,047 - INFO -   merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:29,080 - INFO -   merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:29,113 - INFO -   merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:29,146 - INFO -   merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:29,188 - INFO - Pure FL Round 4 Evaluation:
2025-12-04 12:00:29,188 - INFO -   Accuracy: 0.8706
2025-12-04 12:00:29,188 - INFO -   Precision: 0.8621
2025-12-04 12:00:29,188 - INFO -   Recall: 0.8823
2025-12-04 12:00:29,188 - INFO -   F1-Score: 0.8721
2025-12-04 12:00:29,193 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:29,193 - INFO - Pure FL Round 5/10
2025-12-04 12:00:29,224 - INFO -   merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:29,254 - INFO -   merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:29,284 - INFO -   merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:29,315 - INFO -   merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:29,363 - INFO -   merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:29,402 - INFO - Pure FL Round 5 Evaluation:
2025-12-04 12:00:29,402 - INFO -   Accuracy: 0.8706
2025-12-04 12:00:29,402 - INFO -   Precision: 0.8621
2025-12-04 12:00:29,402 - INFO -   Recall: 0.8823
2025-12-04 12:00:29,402 - INFO -   F1-Score: 0.8721
2025-12-04 12:00:29,402 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:29,402 - INFO - Pure FL Round 6/10
2025-12-04 12:00:29,419 - INFO -   merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:29,446 - INFO -   merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:29,478 - INFO -   merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:29,506 - INFO -   merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:29,535 - INFO -   merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:29,562 - INFO - Pure FL Round 6 Evaluation:
2025-12-04 12:00:29,562 - INFO -   Accuracy: 0.8706
2025-12-04 12:00:29,562 - INFO -   Precision: 0.8621
2025-12-04 12:00:29,562 - INFO -   Recall: 0.8823
2025-12-04 12:00:29,562 - INFO -   F1-Score: 0.8721
2025-12-04 12:00:29,562 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:29,562 - INFO - Pure FL Round 7/10
2025-12-04 12:00:29,585 - INFO -   merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:29,619 - INFO -   merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:29,653 - INFO -   merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:29,683 - INFO -   merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:29,723 - INFO -   merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:29,778 - INFO - Pure FL Round 7 Evaluation:
2025-12-04 12:00:29,778 - INFO -   Accuracy: 0.8706
2025-12-04 12:00:29,778 - INFO -   Precision: 0.8621
2025-12-04 12:00:29,780 - INFO -   Recall: 0.8823
2025-12-04 12:00:29,780 - INFO -   F1-Score: 0.8721
2025-12-04 12:00:29,780 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:29,780 - INFO - Pure FL Round 8/10
2025-12-04 12:00:29,811 - INFO -   merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:29,834 - INFO -   merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:29,860 - INFO -   merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:29,887 - INFO -   merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:29,912 - INFO -   merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:29,945 - INFO - Pure FL Round 8 Evaluation:
2025-12-04 12:00:29,946 - INFO -   Accuracy: 0.8706
2025-12-04 12:00:29,946 - INFO -   Precision: 0.8621
2025-12-04 12:00:29,947 - INFO -   Recall: 0.8823
2025-12-04 12:00:29,947 - INFO -   F1-Score: 0.8721
2025-12-04 12:00:29,947 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:29,947 - INFO - Pure FL Round 9/10
2025-12-04 12:00:29,976 - INFO -   merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:30,006 - INFO -   merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:30,029 - INFO -   merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:30,051 - INFO -   merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:30,085 - INFO -   merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:30,113 - INFO - Pure FL Round 9 Evaluation:
2025-12-04 12:00:30,113 - INFO -   Accuracy: 0.8706
2025-12-04 12:00:30,113 - INFO -   Precision: 0.8621
2025-12-04 12:00:30,113 - INFO -   Recall: 0.8823
2025-12-04 12:00:30,113 - INFO -   F1-Score: 0.8721
2025-12-04 12:00:30,113 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:30,113 - INFO - Pure FL Round 10/10
2025-12-04 12:00:30,140 - INFO -   merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:30,168 - INFO -   merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:30,196 - INFO -   merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:30,227 - INFO -   merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:30,253 - INFO -   merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:30,283 - INFO - Pure FL Round 10 Evaluation:
2025-12-04 12:00:30,283 - INFO -   Accuracy: 0.8706
2025-12-04 12:00:30,283 - INFO -   Precision: 0.8621
2025-12-04 12:00:30,283 - INFO -   Recall: 0.8823
2025-12-04 12:00:30,283 - INFO -   F1-Score: 0.8721
2025-12-04 12:00:30,283 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:30,283 - INFO - Training hierarchical federated learning...
2025-12-04 12:00:30,283 - INFO - Training hierarchical federated learning model...
2025-12-04 12:00:30,283 - INFO - Hierarchical FL Round 1/10
2025-12-04 12:00:30,283 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:00:30,319 - INFO -     merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:30,346 - INFO -     merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:30,370 - INFO -     merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:30,370 - INFO - Aggregating 3 models at edge node
2025-12-04 12:00:30,370 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-04 12:00:30,372 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:00:30,397 - INFO -     merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:30,422 - INFO -     merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:30,422 - INFO - Aggregating 2 models at edge node
2025-12-04 12:00:30,422 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-04 12:00:30,422 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:00:30,422 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:00:30,446 - INFO - Hierarchical FL Round 1 Evaluation:
2025-12-04 12:00:30,446 - INFO -   Accuracy: 0.8700
2025-12-04 12:00:30,446 - INFO -   Precision: 0.8615
2025-12-04 12:00:30,446 - INFO -   Recall: 0.8818
2025-12-04 12:00:30,446 - INFO -   F1-Score: 0.8716
2025-12-04 12:00:30,446 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:30,446 - INFO - Hierarchical FL Round 2/10
2025-12-04 12:00:30,446 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:00:30,476 - INFO -     merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:30,502 - INFO -     merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:30,530 - INFO -     merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:30,532 - INFO - Aggregating 3 models at edge node
2025-12-04 12:00:30,532 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-04 12:00:30,532 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:00:30,558 - INFO -     merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:30,588 - INFO -     merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:30,588 - INFO - Aggregating 2 models at edge node
2025-12-04 12:00:30,588 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-04 12:00:30,588 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:00:30,588 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:00:30,613 - INFO - Hierarchical FL Round 2 Evaluation:
2025-12-04 12:00:30,619 - INFO -   Accuracy: 0.8700
2025-12-04 12:00:30,619 - INFO -   Precision: 0.8615
2025-12-04 12:00:30,619 - INFO -   Recall: 0.8818
2025-12-04 12:00:30,620 - INFO -   F1-Score: 0.8716
2025-12-04 12:00:30,620 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:30,620 - INFO - Hierarchical FL Round 3/10
2025-12-04 12:00:30,620 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:00:30,646 - INFO -     merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:30,671 - INFO -     merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:30,705 - INFO -     merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:30,705 - INFO - Aggregating 3 models at edge node
2025-12-04 12:00:30,705 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-04 12:00:30,705 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:00:30,732 - INFO -     merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:30,749 - INFO -     merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:30,749 - INFO - Aggregating 2 models at edge node
2025-12-04 12:00:30,749 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-04 12:00:30,749 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:00:30,749 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:00:30,783 - INFO - Hierarchical FL Round 3 Evaluation:
2025-12-04 12:00:30,783 - INFO -   Accuracy: 0.8700
2025-12-04 12:00:30,783 - INFO -   Precision: 0.8615
2025-12-04 12:00:30,783 - INFO -   Recall: 0.8818
2025-12-04 12:00:30,783 - INFO -   F1-Score: 0.8716
2025-12-04 12:00:30,788 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:30,788 - INFO - Hierarchical FL Round 4/10
2025-12-04 12:00:30,789 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:00:30,815 - INFO -     merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:30,842 - INFO -     merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:30,871 - INFO -     merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:30,871 - INFO - Aggregating 3 models at edge node
2025-12-04 12:00:30,871 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-04 12:00:30,871 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:00:30,900 - INFO -     merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:30,922 - INFO -     merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:30,922 - INFO - Aggregating 2 models at edge node
2025-12-04 12:00:30,922 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-04 12:00:30,922 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:00:30,922 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:00:30,953 - INFO - Hierarchical FL Round 4 Evaluation:
2025-12-04 12:00:30,953 - INFO -   Accuracy: 0.8700
2025-12-04 12:00:30,953 - INFO -   Precision: 0.8615
2025-12-04 12:00:30,953 - INFO -   Recall: 0.8818
2025-12-04 12:00:30,953 - INFO -   F1-Score: 0.8716
2025-12-04 12:00:30,953 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:30,953 - INFO - Hierarchical FL Round 5/10
2025-12-04 12:00:30,953 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:00:30,982 - INFO -     merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:31,006 - INFO -     merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:31,034 - INFO -     merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:31,034 - INFO - Aggregating 3 models at edge node
2025-12-04 12:00:31,034 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-04 12:00:31,034 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:00:31,063 - INFO -     merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:31,085 - INFO -     merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:31,085 - INFO - Aggregating 2 models at edge node
2025-12-04 12:00:31,085 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-04 12:00:31,085 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:00:31,085 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:00:31,113 - INFO - Hierarchical FL Round 5 Evaluation:
2025-12-04 12:00:31,113 - INFO -   Accuracy: 0.8700
2025-12-04 12:00:31,113 - INFO -   Precision: 0.8615
2025-12-04 12:00:31,113 - INFO -   Recall: 0.8818
2025-12-04 12:00:31,113 - INFO -   F1-Score: 0.8716
2025-12-04 12:00:31,113 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:31,113 - INFO - Hierarchical FL Round 6/10
2025-12-04 12:00:31,113 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:00:31,148 - INFO -     merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:31,179 - INFO -     merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:31,204 - INFO -     merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:31,204 - INFO - Aggregating 3 models at edge node
2025-12-04 12:00:31,204 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-04 12:00:31,207 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:00:31,233 - INFO -     merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:31,258 - INFO -     merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:31,258 - INFO - Aggregating 2 models at edge node
2025-12-04 12:00:31,260 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-04 12:00:31,260 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:00:31,261 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:00:31,288 - INFO - Hierarchical FL Round 6 Evaluation:
2025-12-04 12:00:31,288 - INFO -   Accuracy: 0.8700
2025-12-04 12:00:31,288 - INFO -   Precision: 0.8615
2025-12-04 12:00:31,288 - INFO -   Recall: 0.8818
2025-12-04 12:00:31,290 - INFO -   F1-Score: 0.8716
2025-12-04 12:00:31,290 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:31,290 - INFO - Hierarchical FL Round 7/10
2025-12-04 12:00:31,291 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:00:31,312 - INFO -     merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:31,340 - INFO -     merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:31,364 - INFO -     merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:31,366 - INFO - Aggregating 3 models at edge node
2025-12-04 12:00:31,366 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-04 12:00:31,366 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:00:31,391 - INFO -     merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:31,419 - INFO -     merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:31,419 - INFO - Aggregating 2 models at edge node
2025-12-04 12:00:31,419 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-04 12:00:31,419 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:00:31,419 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:00:31,452 - INFO - Hierarchical FL Round 7 Evaluation:
2025-12-04 12:00:31,452 - INFO -   Accuracy: 0.8700
2025-12-04 12:00:31,452 - INFO -   Precision: 0.8615
2025-12-04 12:00:31,452 - INFO -   Recall: 0.8818
2025-12-04 12:00:31,454 - INFO -   F1-Score: 0.8716
2025-12-04 12:00:31,454 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:31,454 - INFO - Hierarchical FL Round 8/10
2025-12-04 12:00:31,455 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:00:31,481 - INFO -     merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:31,508 - INFO -     merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:31,534 - INFO -     merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:31,534 - INFO - Aggregating 3 models at edge node
2025-12-04 12:00:31,534 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-04 12:00:31,534 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:00:31,568 - INFO -     merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:31,596 - INFO -     merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:31,596 - INFO - Aggregating 2 models at edge node
2025-12-04 12:00:31,596 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-04 12:00:31,596 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:00:31,596 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:00:31,623 - INFO - Hierarchical FL Round 8 Evaluation:
2025-12-04 12:00:31,623 - INFO -   Accuracy: 0.8700
2025-12-04 12:00:31,623 - INFO -   Precision: 0.8615
2025-12-04 12:00:31,623 - INFO -   Recall: 0.8818
2025-12-04 12:00:31,625 - INFO -   F1-Score: 0.8716
2025-12-04 12:00:31,625 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:31,626 - INFO - Hierarchical FL Round 9/10
2025-12-04 12:00:31,627 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:00:31,653 - INFO -     merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:31,684 - INFO -     merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:31,715 - INFO -     merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:31,715 - INFO - Aggregating 3 models at edge node
2025-12-04 12:00:31,715 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-04 12:00:31,715 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:00:31,745 - INFO -     merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:31,768 - INFO -     merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:31,768 - INFO - Aggregating 2 models at edge node
2025-12-04 12:00:31,768 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-04 12:00:31,768 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:00:31,768 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:00:31,796 - INFO - Hierarchical FL Round 9 Evaluation:
2025-12-04 12:00:31,796 - INFO -   Accuracy: 0.8700
2025-12-04 12:00:31,796 - INFO -   Precision: 0.8615
2025-12-04 12:00:31,796 - INFO -   Recall: 0.8818
2025-12-04 12:00:31,796 - INFO -   F1-Score: 0.8716
2025-12-04 12:00:31,801 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:31,801 - INFO - Hierarchical FL Round 10/10
2025-12-04 12:00:31,801 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:00:31,819 - INFO -     merchant_1: 12777 samples, loss: 0.2983
2025-12-04 12:00:31,849 - INFO -     merchant_2: 12777 samples, loss: 0.3044
2025-12-04 12:00:31,868 - INFO -     merchant_3: 12777 samples, loss: 0.2929
2025-12-04 12:00:31,868 - INFO - Aggregating 3 models at edge node
2025-12-04 12:00:31,868 - INFO -     edge_1 aggregated 3 models (38331 total samples)
2025-12-04 12:00:31,874 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:00:31,901 - INFO -     merchant_4: 12777 samples, loss: 0.2978
2025-12-04 12:00:31,931 - INFO -     merchant_5: 12779 samples, loss: 0.3006
2025-12-04 12:00:31,931 - INFO - Aggregating 2 models at edge node
2025-12-04 12:00:31,931 - INFO -     edge_2 aggregated 2 models (25556 total samples)
2025-12-04 12:00:31,931 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:00:31,931 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:00:31,958 - INFO - Hierarchical FL Round 10 Evaluation:
2025-12-04 12:00:31,958 - INFO -   Accuracy: 0.8700
2025-12-04 12:00:31,960 - INFO -   Precision: 0.8615
2025-12-04 12:00:31,960 - INFO -   Recall: 0.8818
2025-12-04 12:00:31,961 - INFO -   F1-Score: 0.8716
2025-12-04 12:00:31,961 - INFO -   ROC-AUC: 0.9411
2025-12-04 12:00:31,963 - INFO - Generating performance comparison...
2025-12-04 12:00:31,969 - INFO - Plotting training curves...
2025-12-04 12:01:21,700 - INFO - Saving models...
2025-12-04 12:01:21,712 - INFO - Saved centralized model to d:/PracticeProject/fraud_detection_project\trained_models\centralized_model.pkl
2025-12-04 12:01:21,719 - INFO - Saved pure_fl model to d:/PracticeProject/fraud_detection_project\trained_models\pure_fl_model.pkl
2025-12-04 12:01:21,724 - INFO - Saved hierarchical_fl model to d:/PracticeProject/fraud_detection_project\trained_models\hierarchical_fl_model.pkl
2025-12-04 12:01:21,730 - INFO - Experiment completed successfully! Results saved to d:/PracticeProject/fraud_detection_project\experiment_results_smote_logistic.json
2025-12-04 12:01:21,730 - INFO - Starting complete FL experiment with adasyn data and mlp model
2025-12-04 12:01:21,730 - INFO - Loading data with balance method: adasyn
2025-12-04 12:01:22,262 - INFO - Merchant 1: 12780 train, 3196 test samples
2025-12-04 12:01:22,262 - INFO -   Fraud rate: 50.09%
2025-12-04 12:01:22,812 - INFO - Merchant 2: 12780 train, 3196 test samples
2025-12-04 12:01:22,812 - INFO -   Fraud rate: 49.72%
2025-12-04 12:01:23,349 - INFO - Merchant 3: 12780 train, 3196 test samples
2025-12-04 12:01:23,349 - INFO -   Fraud rate: 50.38%
2025-12-04 12:01:23,880 - INFO - Merchant 4: 12780 train, 3196 test samples
2025-12-04 12:01:23,880 - INFO -   Fraud rate: 50.65%
2025-12-04 12:01:24,415 - INFO - Merchant 5: 12782 train, 3196 test samples
2025-12-04 12:01:24,415 - INFO -   Fraud rate: 49.21%
2025-12-04 12:01:24,415 - INFO - Successfully loaded data for 5 merchants
2025-12-04 12:01:24,415 - INFO - Training centralized baseline...
2025-12-04 12:01:24,415 - INFO - Training centralized baseline model...
2025-12-04 12:01:52,645 - INFO - Centralized Baseline Evaluation:
2025-12-04 12:01:52,647 - INFO -   Accuracy: 0.9992
2025-12-04 12:01:52,647 - INFO -   Precision: 0.9984
2025-12-04 12:01:52,647 - INFO -   Recall: 1.0000
2025-12-04 12:01:52,647 - INFO -   F1-Score: 0.9992
2025-12-04 12:01:52,647 - INFO -   ROC-AUC: 0.9999
2025-12-04 12:01:52,651 - INFO - Training pure federated learning...
2025-12-04 12:01:52,651 - INFO - Training pure federated learning model...
2025-12-04 12:01:52,778 - INFO - Pure FL Round 1/10
2025-12-04 12:02:05,420 - INFO -   merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:02:14,493 - INFO -   merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:02:26,874 - INFO -   merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:02:39,678 - INFO -   merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:02:51,824 - INFO -   merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:02:51,951 - INFO - Pure FL Round 1 Evaluation:
2025-12-04 12:02:51,951 - INFO -   Accuracy: 0.7103
2025-12-04 12:02:51,951 - INFO -   Precision: 0.6431
2025-12-04 12:02:51,951 - INFO -   Recall: 0.9451
2025-12-04 12:02:51,951 - INFO -   F1-Score: 0.7654
2025-12-04 12:02:51,951 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:02:51,951 - INFO - Pure FL Round 2/10
2025-12-04 12:03:04,095 - INFO -   merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:03:16,412 - INFO -   merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:03:27,807 - INFO -   merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:03:40,684 - INFO -   merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:03:53,806 - INFO -   merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:03:53,918 - INFO - Pure FL Round 2 Evaluation:
2025-12-04 12:03:53,920 - INFO -   Accuracy: 0.7103
2025-12-04 12:03:53,920 - INFO -   Precision: 0.6431
2025-12-04 12:03:53,920 - INFO -   Recall: 0.9451
2025-12-04 12:03:53,922 - INFO -   F1-Score: 0.7654
2025-12-04 12:03:53,922 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:03:53,922 - INFO - Pure FL Round 3/10
2025-12-04 12:04:06,363 - INFO -   merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:04:18,726 - INFO -   merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:04:31,768 - INFO -   merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:04:45,490 - INFO -   merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:04:58,399 - INFO -   merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:04:58,525 - INFO - Pure FL Round 3 Evaluation:
2025-12-04 12:04:58,525 - INFO -   Accuracy: 0.7103
2025-12-04 12:04:58,525 - INFO -   Precision: 0.6431
2025-12-04 12:04:58,525 - INFO -   Recall: 0.9451
2025-12-04 12:04:58,525 - INFO -   F1-Score: 0.7654
2025-12-04 12:04:58,528 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:04:58,528 - INFO - Pure FL Round 4/10
2025-12-04 12:05:11,521 - INFO -   merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:05:24,511 - INFO -   merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:05:36,590 - INFO -   merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:05:48,372 - INFO -   merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:06:00,688 - INFO -   merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:06:00,791 - INFO - Pure FL Round 4 Evaluation:
2025-12-04 12:06:00,802 - INFO -   Accuracy: 0.7103
2025-12-04 12:06:00,802 - INFO -   Precision: 0.6431
2025-12-04 12:06:00,802 - INFO -   Recall: 0.9451
2025-12-04 12:06:00,802 - INFO -   F1-Score: 0.7654
2025-12-04 12:06:00,802 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:06:00,802 - INFO - Pure FL Round 5/10
2025-12-04 12:06:13,506 - INFO -   merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:06:25,157 - INFO -   merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:06:37,164 - INFO -   merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:06:49,065 - INFO -   merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:07:00,966 - INFO -   merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:07:01,080 - INFO - Pure FL Round 5 Evaluation:
2025-12-04 12:07:01,080 - INFO -   Accuracy: 0.7103
2025-12-04 12:07:01,080 - INFO -   Precision: 0.6431
2025-12-04 12:07:01,080 - INFO -   Recall: 0.9451
2025-12-04 12:07:01,080 - INFO -   F1-Score: 0.7654
2025-12-04 12:07:01,080 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:07:01,080 - INFO - Pure FL Round 6/10
2025-12-04 12:07:12,476 - INFO -   merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:07:23,843 - INFO -   merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:07:35,829 - INFO -   merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:07:48,335 - INFO -   merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:08:00,996 - INFO -   merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:08:01,113 - INFO - Pure FL Round 6 Evaluation:
2025-12-04 12:08:01,114 - INFO -   Accuracy: 0.7103
2025-12-04 12:08:01,114 - INFO -   Precision: 0.6431
2025-12-04 12:08:01,115 - INFO -   Recall: 0.9451
2025-12-04 12:08:01,115 - INFO -   F1-Score: 0.7654
2025-12-04 12:08:01,116 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:08:01,116 - INFO - Pure FL Round 7/10
2025-12-04 12:08:13,758 - INFO -   merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:08:26,111 - INFO -   merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:08:38,717 - INFO -   merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:08:51,397 - INFO -   merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:09:03,915 - INFO -   merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:09:04,028 - INFO - Pure FL Round 7 Evaluation:
2025-12-04 12:09:04,028 - INFO -   Accuracy: 0.7103
2025-12-04 12:09:04,028 - INFO -   Precision: 0.6431
2025-12-04 12:09:04,028 - INFO -   Recall: 0.9451
2025-12-04 12:09:04,028 - INFO -   F1-Score: 0.7654
2025-12-04 12:09:04,028 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:09:04,028 - INFO - Pure FL Round 8/10
2025-12-04 12:09:16,106 - INFO -   merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:09:22,937 - INFO -   merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:09:32,722 - INFO -   merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:09:41,720 - INFO -   merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:09:54,822 - INFO -   merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:09:54,920 - INFO - Pure FL Round 8 Evaluation:
2025-12-04 12:09:54,921 - INFO -   Accuracy: 0.7103
2025-12-04 12:09:54,921 - INFO -   Precision: 0.6431
2025-12-04 12:09:54,923 - INFO -   Recall: 0.9451
2025-12-04 12:09:54,923 - INFO -   F1-Score: 0.7654
2025-12-04 12:09:54,924 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:09:54,924 - INFO - Pure FL Round 9/10
2025-12-04 12:10:04,018 - INFO -   merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:10:10,296 - INFO -   merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:10:16,460 - INFO -   merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:10:23,290 - INFO -   merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:10:29,908 - INFO -   merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:10:29,948 - INFO - Pure FL Round 9 Evaluation:
2025-12-04 12:10:29,948 - INFO -   Accuracy: 0.7103
2025-12-04 12:10:29,948 - INFO -   Precision: 0.6431
2025-12-04 12:10:29,948 - INFO -   Recall: 0.9451
2025-12-04 12:10:29,948 - INFO -   F1-Score: 0.7654
2025-12-04 12:10:29,948 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:10:29,950 - INFO - Pure FL Round 10/10
2025-12-04 12:10:36,323 - INFO -   merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:10:42,548 - INFO -   merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:10:49,305 - INFO -   merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:10:55,627 - INFO -   merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:11:02,186 - INFO -   merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:11:02,245 - INFO - Pure FL Round 10 Evaluation:
2025-12-04 12:11:02,245 - INFO -   Accuracy: 0.7103
2025-12-04 12:11:02,245 - INFO -   Precision: 0.6431
2025-12-04 12:11:02,245 - INFO -   Recall: 0.9451
2025-12-04 12:11:02,245 - INFO -   F1-Score: 0.7654
2025-12-04 12:11:02,245 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:11:02,245 - INFO - Training hierarchical federated learning...
2025-12-04 12:11:02,245 - INFO - Training hierarchical federated learning model...
2025-12-04 12:11:02,272 - INFO - Hierarchical FL Round 1/10
2025-12-04 12:11:02,272 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:11:08,772 - INFO -     merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:11:15,474 - INFO -     merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:11:22,218 - INFO -     merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:11:22,218 - INFO - Aggregating 3 models at edge node
2025-12-04 12:11:22,218 - INFO -     edge_1 aggregated 3 models (38340 total samples)
2025-12-04 12:11:22,226 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:11:28,755 - INFO -     merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:11:35,554 - INFO -     merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:11:35,554 - INFO - Aggregating 2 models at edge node
2025-12-04 12:11:35,554 - INFO -     edge_2 aggregated 2 models (25562 total samples)
2025-12-04 12:11:35,554 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:11:35,554 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:11:35,592 - INFO - Hierarchical FL Round 1 Evaluation:
2025-12-04 12:11:35,592 - INFO -   Accuracy: 0.7103
2025-12-04 12:11:35,592 - INFO -   Precision: 0.6431
2025-12-04 12:11:35,593 - INFO -   Recall: 0.9451
2025-12-04 12:11:35,593 - INFO -   F1-Score: 0.7654
2025-12-04 12:11:35,593 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:11:35,593 - INFO - Hierarchical FL Round 2/10
2025-12-04 12:11:35,594 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:11:40,922 - INFO -     merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:11:46,114 - INFO -     merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:11:52,351 - INFO -     merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:11:52,351 - INFO - Aggregating 3 models at edge node
2025-12-04 12:11:52,351 - INFO -     edge_1 aggregated 3 models (38340 total samples)
2025-12-04 12:11:52,361 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:11:58,376 - INFO -     merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:12:04,566 - INFO -     merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:12:04,566 - INFO - Aggregating 2 models at edge node
2025-12-04 12:12:04,566 - INFO -     edge_2 aggregated 2 models (25562 total samples)
2025-12-04 12:12:04,566 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:12:04,566 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:12:04,611 - INFO - Hierarchical FL Round 2 Evaluation:
2025-12-04 12:12:04,611 - INFO -   Accuracy: 0.7103
2025-12-04 12:12:04,611 - INFO -   Precision: 0.6431
2025-12-04 12:12:04,611 - INFO -   Recall: 0.9451
2025-12-04 12:12:04,615 - INFO -   F1-Score: 0.7654
2025-12-04 12:12:04,615 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:12:04,615 - INFO - Hierarchical FL Round 3/10
2025-12-04 12:12:04,615 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:12:10,865 - INFO -     merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:12:16,968 - INFO -     merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:12:23,197 - INFO -     merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:12:23,197 - INFO - Aggregating 3 models at edge node
2025-12-04 12:12:23,197 - INFO -     edge_1 aggregated 3 models (38340 total samples)
2025-12-04 12:12:23,197 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:12:29,737 - INFO -     merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:12:34,597 - INFO -     merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:12:34,597 - INFO - Aggregating 2 models at edge node
2025-12-04 12:12:34,597 - INFO -     edge_2 aggregated 2 models (25562 total samples)
2025-12-04 12:12:34,597 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:12:34,597 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:12:34,637 - INFO - Hierarchical FL Round 3 Evaluation:
2025-12-04 12:12:34,637 - INFO -   Accuracy: 0.7103
2025-12-04 12:12:34,637 - INFO -   Precision: 0.6431
2025-12-04 12:12:34,637 - INFO -   Recall: 0.9451
2025-12-04 12:12:34,637 - INFO -   F1-Score: 0.7654
2025-12-04 12:12:34,637 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:12:34,637 - INFO - Hierarchical FL Round 4/10
2025-12-04 12:12:34,637 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:12:38,774 - INFO -     merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:12:43,621 - INFO -     merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:12:49,628 - INFO -     merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:12:49,628 - INFO - Aggregating 3 models at edge node
2025-12-04 12:12:49,628 - INFO -     edge_1 aggregated 3 models (38340 total samples)
2025-12-04 12:12:49,628 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:12:56,126 - INFO -     merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:13:02,712 - INFO -     merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:13:02,712 - INFO - Aggregating 2 models at edge node
2025-12-04 12:13:02,712 - INFO -     edge_2 aggregated 2 models (25562 total samples)
2025-12-04 12:13:02,712 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:13:02,712 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:13:02,770 - INFO - Hierarchical FL Round 4 Evaluation:
2025-12-04 12:13:02,770 - INFO -   Accuracy: 0.7103
2025-12-04 12:13:02,770 - INFO -   Precision: 0.6431
2025-12-04 12:13:02,770 - INFO -   Recall: 0.9451
2025-12-04 12:13:02,770 - INFO -   F1-Score: 0.7654
2025-12-04 12:13:02,770 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:13:02,770 - INFO - Hierarchical FL Round 5/10
2025-12-04 12:13:02,770 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:13:08,841 - INFO -     merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:13:15,120 - INFO -     merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:13:21,380 - INFO -     merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:13:21,380 - INFO - Aggregating 3 models at edge node
2025-12-04 12:13:21,380 - INFO -     edge_1 aggregated 3 models (38340 total samples)
2025-12-04 12:13:21,380 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:13:27,837 - INFO -     merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:13:34,770 - INFO -     merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:13:34,770 - INFO - Aggregating 2 models at edge node
2025-12-04 12:13:34,770 - INFO -     edge_2 aggregated 2 models (25562 total samples)
2025-12-04 12:13:34,770 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:13:34,770 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:13:34,825 - INFO - Hierarchical FL Round 5 Evaluation:
2025-12-04 12:13:34,825 - INFO -   Accuracy: 0.7103
2025-12-04 12:13:34,825 - INFO -   Precision: 0.6431
2025-12-04 12:13:34,825 - INFO -   Recall: 0.9451
2025-12-04 12:13:34,828 - INFO -   F1-Score: 0.7654
2025-12-04 12:13:34,828 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:13:34,828 - INFO - Hierarchical FL Round 6/10
2025-12-04 12:13:34,828 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:13:40,916 - INFO -     merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:13:46,546 - INFO -     merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:13:52,864 - INFO -     merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:13:52,864 - INFO - Aggregating 3 models at edge node
2025-12-04 12:13:52,864 - INFO -     edge_1 aggregated 3 models (38340 total samples)
2025-12-04 12:13:52,864 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:13:59,128 - INFO -     merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:14:05,446 - INFO -     merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:14:05,446 - INFO - Aggregating 2 models at edge node
2025-12-04 12:14:05,446 - INFO -     edge_2 aggregated 2 models (25562 total samples)
2025-12-04 12:14:05,446 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:14:05,446 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:14:05,489 - INFO - Hierarchical FL Round 6 Evaluation:
2025-12-04 12:14:05,489 - INFO -   Accuracy: 0.7103
2025-12-04 12:14:05,489 - INFO -   Precision: 0.6431
2025-12-04 12:14:05,495 - INFO -   Recall: 0.9451
2025-12-04 12:14:05,495 - INFO -   F1-Score: 0.7654
2025-12-04 12:14:05,495 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:14:05,496 - INFO - Hierarchical FL Round 7/10
2025-12-04 12:14:05,497 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:14:11,546 - INFO -     merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:14:19,171 - INFO -     merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:14:26,656 - INFO -     merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:14:26,656 - INFO - Aggregating 3 models at edge node
2025-12-04 12:14:26,661 - INFO -     edge_1 aggregated 3 models (38340 total samples)
2025-12-04 12:14:26,662 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:14:33,162 - INFO -     merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:14:40,864 - INFO -     merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:14:40,864 - INFO - Aggregating 2 models at edge node
2025-12-04 12:14:40,864 - INFO -     edge_2 aggregated 2 models (25562 total samples)
2025-12-04 12:14:40,864 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:14:40,864 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:14:40,912 - INFO - Hierarchical FL Round 7 Evaluation:
2025-12-04 12:14:40,912 - INFO -   Accuracy: 0.7103
2025-12-04 12:14:40,912 - INFO -   Precision: 0.6431
2025-12-04 12:14:40,912 - INFO -   Recall: 0.9451
2025-12-04 12:14:40,912 - INFO -   F1-Score: 0.7654
2025-12-04 12:14:40,912 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:14:40,912 - INFO - Hierarchical FL Round 8/10
2025-12-04 12:14:40,912 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:14:48,931 - INFO -     merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:14:55,470 - INFO -     merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:15:02,647 - INFO -     merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:15:02,647 - INFO - Aggregating 3 models at edge node
2025-12-04 12:15:02,647 - INFO -     edge_1 aggregated 3 models (38340 total samples)
2025-12-04 12:15:02,647 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:15:10,781 - INFO -     merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:15:18,267 - INFO -     merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:15:18,270 - INFO - Aggregating 2 models at edge node
2025-12-04 12:15:18,271 - INFO -     edge_2 aggregated 2 models (25562 total samples)
2025-12-04 12:15:18,271 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:15:18,271 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:15:18,334 - INFO - Hierarchical FL Round 8 Evaluation:
2025-12-04 12:15:18,334 - INFO -   Accuracy: 0.7103
2025-12-04 12:15:18,334 - INFO -   Precision: 0.6431
2025-12-04 12:15:18,341 - INFO -   Recall: 0.9451
2025-12-04 12:15:18,341 - INFO -   F1-Score: 0.7654
2025-12-04 12:15:18,342 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:15:18,342 - INFO - Hierarchical FL Round 9/10
2025-12-04 12:15:18,342 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:15:26,535 - INFO -     merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:15:33,941 - INFO -     merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:15:41,011 - INFO -     merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:15:41,011 - INFO - Aggregating 3 models at edge node
2025-12-04 12:15:41,011 - INFO -     edge_1 aggregated 3 models (38340 total samples)
2025-12-04 12:15:41,011 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:15:48,946 - INFO -     merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:15:56,672 - INFO -     merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:15:56,673 - INFO - Aggregating 2 models at edge node
2025-12-04 12:15:56,674 - INFO -     edge_2 aggregated 2 models (25562 total samples)
2025-12-04 12:15:56,674 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:15:56,674 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:15:56,745 - INFO - Hierarchical FL Round 9 Evaluation:
2025-12-04 12:15:56,745 - INFO -   Accuracy: 0.7103
2025-12-04 12:15:56,745 - INFO -   Precision: 0.6431
2025-12-04 12:15:56,745 - INFO -   Recall: 0.9451
2025-12-04 12:15:56,745 - INFO -   F1-Score: 0.7654
2025-12-04 12:15:56,745 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:15:56,745 - INFO - Hierarchical FL Round 10/10
2025-12-04 12:15:56,745 - INFO -   Processing edge_1 with merchants [1, 2, 3]
2025-12-04 12:16:03,520 - INFO -     merchant_1: 12780 samples, loss: 0.0003
2025-12-04 12:16:13,537 - INFO -     merchant_2: 12780 samples, loss: 0.0003
2025-12-04 12:16:22,122 - INFO -     merchant_3: 12780 samples, loss: 0.0002
2025-12-04 12:16:22,123 - INFO - Aggregating 3 models at edge node
2025-12-04 12:16:22,125 - INFO -     edge_1 aggregated 3 models (38340 total samples)
2025-12-04 12:16:22,125 - INFO -   Processing edge_2 with merchants [4, 5]
2025-12-04 12:16:30,447 - INFO -     merchant_4: 12780 samples, loss: 0.0003
2025-12-04 12:16:40,558 - INFO -     merchant_5: 12782 samples, loss: 0.0003
2025-12-04 12:16:40,560 - INFO - Aggregating 2 models at edge node
2025-12-04 12:16:40,562 - INFO -     edge_2 aggregated 2 models (25562 total samples)
2025-12-04 12:16:40,563 - INFO - Aggregating 2 edge models at central server
2025-12-04 12:16:40,563 - INFO -   Central server aggregated 2 edge nodes
2025-12-04 12:16:40,706 - INFO - Hierarchical FL Round 10 Evaluation:
2025-12-04 12:16:40,706 - INFO -   Accuracy: 0.7103
2025-12-04 12:16:40,708 - INFO -   Precision: 0.6431
2025-12-04 12:16:40,708 - INFO -   Recall: 0.9451
2025-12-04 12:16:40,709 - INFO -   F1-Score: 0.7654
2025-12-04 12:16:40,709 - INFO -   ROC-AUC: 0.8465
2025-12-04 12:16:40,710 - INFO - Generating performance comparison...
2025-12-04 12:16:40,727 - INFO - Plotting training curves...
2025-12-04 12:17:13,608 - INFO - Saving models...
2025-12-04 12:17:13,645 - INFO - Saved centralized model to d:/PracticeProject/fraud_detection_project\trained_models\centralized_model.pkl
2025-12-04 12:17:13,654 - INFO - Saved pure_fl model to d:/PracticeProject/fraud_detection_project\trained_models\pure_fl_model.pkl
2025-12-04 12:17:13,663 - INFO - Saved hierarchical_fl model to d:/PracticeProject/fraud_detection_project\trained_models\hierarchical_fl_model.pkl
2025-12-04 12:17:13,669 - INFO - Experiment completed successfully! Results saved to d:/PracticeProject/fraud_detection_project\experiment_results_adasyn_mlp.json
